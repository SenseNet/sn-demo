<Package type='Install'>
  <Id>SenseNet.Demo</Id>
  <Description>sensenet Demo</Description>
  <ReleaseDate>2017-08-01</ReleaseDate>
  <Version>7.0.0</Version>
  <Dependencies>
    <Dependency id='SenseNet.Services' minVersion='7.0.0' />
  </Dependencies>
  <Parameters>
  </Parameters>
  <Steps>
    <Phase>
      <StartRepository startWorkflowEngine="false" />

      <!-- Set the default oos server url-->

      <EditJson Path="/Root/System/Settings/OfficeOnline.settings">
        {
        OfficeOnlineUrl: "https://oos.sensenet.com/"
        }
      </EditJson>

      <!-- Set max preview count -->

      <EditJson Path="/Root/System/Settings/DocumentPreview.settings">
        {
        MaxPreviewCount: 2
        }
      </EditJson>

      <!-- Set allowed origins -->

      <EditJson Path="/Root/System/Settings/Portal.settings">
        {
        "AllowedOriginDomains": [
        "*.csb.app",
        "localhost",
        "localhost:8080",
        "*.sensenet.com",
        "*.netlify.com"
        ]
        }
      </EditJson>

      <Import target="/Root" LogLevel="Verbose" source="import" />


      <SetField name="Index" content="/Root/System/Settings/Portal.settings">10</SetField>
      <SetField name="Index" content="/Root/System/Settings/OAuth.settings">20</SetField>
      <SetField name="Index" content="/Root/System/Settings/DocumentPreview.settings">30</SetField>
      <SetField name="Index" content="/Root/System/Settings/OfficeOnline.settings">40</SetField>
      <SetField name="Index" content="/Root/System/Settings/Indexing.settings">50</SetField>
      <SetField name="Index" content="/Root/System/Settings/Sharing.settings">60</SetField>
      <SetField name="Index" content="/Root/System/Settings/Logging.settings">100</SetField>
      <SetField name="Index" content="/Root/System/Settings/MailProcessor.settings">200</SetField>
      <SetField name="Index" content="/Root/System/Settings/UserProfile.settings">300</SetField>
      <SetField name="Index" content="/Root/System/Settings/TaskManagement.settings">400</SetField>

      <AddMembers group="/Root/IMS/BuiltIn/Portal/IdentifiedUsers">
        /Root/IMS/Public/alba
      </AddMembers>

      <!-- Set permissions on settings -->

      <SetPermissions path="/Root/System/Settings" identity="/Root/IMS/Public/Administrators" allow="Open" localOnly="True" />
      <SetPermissions path="/Root/System/Settings" identity="/Root/IMS/Public/Developers" allow="Open" localOnly="True" />

      <SetPermissions path="/Root/System/Settings/Portal.settings" identity="/Root/IMS/Public/Administrators" allow="Open,Save" />
      <SetPermissions path="/Root/System/Settings/OAuth.settings" identity="/Root/IMS/Public/Administrators" allow="Open,Save" />
      <SetPermissions path="/Root/System/Settings/DocumentPreview.settings" identity="/Root/IMS/Public/Administrators" allow="Open,Save" />
      <SetPermissions path="/Root/System/Settings/OfficeOnline.settings" identity="/Root/IMS/Public/Administrators" allow="Open,Save" />
      <SetPermissions path="/Root/System/Settings/Indexing.settings" identity="/Root/IMS/Public/Administrators" allow="Open,Save" />
      <SetPermissions path="/Root/System/Settings/Sharing.settings" identity="/Root/IMS/Public/Administrators" allow="Open,Save" />

      <SetPermissions path="/Root/System/Settings/Portal.settings" identity="/Root/IMS/Public/Developers" allow="Save" />
      <SetPermissions path="/Root/System/Settings/OAuth.settings" identity="/Root/IMS/Public/Developers" allow="Save" />
      <SetPermissions path="/Root/System/Settings/DocumentPreview.settings" identity="/Root/IMS/Public/Developers" allow="Save" />
      <SetPermissions path="/Root/System/Settings/OfficeOnline.settings" identity="/Root/IMS/Public/Developers" allow="Save" />
      <SetPermissions path="/Root/System/Settings/Indexing.settings" identity="/Root/IMS/Public/Developers" allow="Save" />
      <SetPermissions path="/Root/System/Settings/Sharing.settings" identity="/Root/IMS/Public/Developers" allow="Save" />

      <!-- set ctd permissions for built-in groups -->

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ContentLink" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ContentLink" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/User" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/User" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File/Image" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File/Image" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File/Settings/PortalSettings" identity="/Root/IMS/Public/Developers" allow="See,Open,RunApplication" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File/Settings/PortalSettings" identity="/Root/IMS/Public/Administrators" allow="See,Open,RunApplication" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File/Settings/IndexingSettings" identity="/Root/IMS/Public/Developers" allow="See,Open,RunApplication" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File/Settings/IndexingSettings" identity="/Root/IMS/Public/Administrators" allow="See,Open,RunApplication" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File/Settings/LoggingSettings" identity="/Root/IMS/Public/Developers" allow="See,Open,RunApplication" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/File/Settings/LoggingSettings" identity="/Root/IMS/Public/Administrators" allow="See,Open,RunApplication" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/Library/ImageLibrary" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/Library/ImageLibrary" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/Library/DocumentLibrary" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/Library/DocumentLibrary" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/ItemList/EventList" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/ItemList/EventList" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/ItemList/LinkList" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/ItemList/LinkList" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/ItemList/MemoList" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/ItemList/MemoList" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/ItemList/TaskList" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ContentList/ItemList/TaskList" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/SmartFolder" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/SmartFolder" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/Workspace" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/Workspace" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/CalendarEvent" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/CalendarEvent" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/Link" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/Link" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/Memo" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/Memo" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/Task" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/Task" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/OrganizationalUnit" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/OrganizationalUnit" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ArticleSection" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/Folder/ArticleSection" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />

      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/WebContent/Article" identity="/Root/IMS/Public/Developers" allow="Save" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes/GenericContent/ListItem/WebContent/Article" identity="/Root/IMS/Public/Administrators" allow="Save" localOnly="True" />


      <!-- Set permissions on top level containers folders for built-in users -->

      <SetPermissions path="/Root/IMS/Public" identity="/Root/IMS/Public/Developers" allow="AddNew" />
      <SetPermissions path="/Root/IMS/Public" identity="/Root/IMS/Public/Administrators" allow="AddNew" />

      <SetPermissions path="/Root/System/Schema/ContentTypes" identity="/Root/IMS/Public/Developers" allow="AddNew" localOnly="True" />
      <SetPermissions path="/Root/System/Schema/ContentTypes" identity="/Root/IMS/Public/Administrators" allow="AddNew" localOnly="True" />

      <SetPermissions path="/Root/Localization" identity="/Root/IMS/Public/Developers" allow="AddNew" />
      <SetPermissions path="/Root/Localization" identity="/Root/IMS/Public/Administrators" allow="AddNew" />

      <SetPermissions path="/Root/Content" identity="/Root/IMS/Public/Developers" allow="AddNew;Save;ManageListsAndWorkspaces;Delete;Publish;ForceCheckin;RecallOldVersion;SeePermissions;SetPermissions" />
      <SetPermissions path="/Root/Content" identity="/Root/IMS/Public/Administrators" allow="AddNew;Save;ManageListsAndWorkspaces;Delete;Publish;ForceCheckin;Approve;RecallOldVersion;SeePermissions;SetPermissions;TakeOwnership" />
      <SetPermissions path="/Root/Content" identity="/Root/IMS/Public/Editors" allow="AddNew;Save;ManageListsAndWorkspaces;Delete;Publish" />

      <SetPermissions path="/Root/Trash" identity="/Root/IMS/Public/Developers" allow="Save" />
      <SetPermissions path="/Root/Trash" identity="/Root/IMS/Public/Administrators" allow="Save" />
    </Phase>
  </Steps>
</Package>
